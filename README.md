# mod_spnopenweather
The weather module for Joomla CMS

Модуль погоды для сайта на CMS Joomla позволят выводить погоду на нужных страницах сайта в нужном формате. Основные преимущества модуля:

  - API запросы к серверу погоды на уровне серверного кода (т.е. у вас нет ни каких видимых для поисковиков ссылок на сервер погоды, что позволяет избежать огромного количества ссылок на сервер погоды в отличие от погодных информеров на JS)
  - Настраиваемое кеширование запросов - позволяет на бесплатных аккаунтах сервера погоды openweathermap.org вполне комфортно работать.
  - Настраиваемое отображение погоды (от формы-информера до простой строки текста - см. примеры на https://seoprosto.net/services/software/joomla-weather)
  
Установка модуля погоды:

Для установки скачиваем архив mod_spnopenweather.zip и устанавливаем в joomla обычным образом. После установки  у вас появится выключенный модуль mod_spnopenweather, а так же, вам становится  доступным для добавления модуль mod_spnopenweather. Для работы модуля вам понадобиться аккаунт на https://openweathermap.org

Заведение аккаунта на openweathermap.org:

Погодный модуль spnopenweather использует openweathermap.org для получения по API информации о погоде. Для этого вам надо завести на этом сайте аккаунт. Для "обычного" использования вам скорее всего хватит бесплатного аккаунта (60 запросов в минуту на бесплатном аккаунте с учетом кеширования модуля огромная цифра!).

Информация о тарифных планах включая бесплатный представлена на https://openweathermap.org/price

И так, регистрируемся по по ссылке "Sign Up" в верхней строке на сайте или идем сразу на страницу регистрации https://home.openweathermap.org/users/sign_up (для регистрации нужен e-mail и пароль).

После регистрации на закладке "API keys" создаем ключ (нажимаем кнопку "Generate") и как пишут владельцы ресурса, ключ будет "готов для использования" минут через десять. Т.е. минут 10 потребуется системе, что бы созданный ключ стал активен в системе.

На этом все - это  ключ копируем Сtrl+C и сохраняем в настройках каждого модуля mod_spnopenweather.

Настройка модуля погоды:

Для вывода информации о погоде вам необходимо добавить столько экземпляров модулей, сколько раз вы собираетесь выводить "погоду". Например, представленная выше информация о погоде реализована пятью модулями. Три модуля использованы для иллюстрации погодных информеров с разным набором информации (см. первые три погодных информера), и два использованы для выводе в тексте температуры и давления.

Каждый экземпляр модуля содержит в себе однотипные настройки. Т.о. если у вас планируется много однообразных информеров (например, у вас сайт турагентства, и вы на каждой странице описания страны/города собираетесь выводить информацию о погоде, как на http://iliantour.ru/country/turkey/antalya), то вам тогда целесообразно настроить один модуль, а потом осуществлять его дублирование, заменяя "город" для показа.

В каждом модуле есть закладка настройки параметров модуля, которые представлены ниже:


OpenWeather KEY - XXXXXXXXXXXXX (ключ, который копируете из аккаунта на openweathermap.org)

Лимит запросов в мин. - 60 (60 - это бесплатный аккаунт. Если у вас платный, то ставьте то, что дает ваш аккаунт)

Таймаут (мс) -  3000 (время ожидания ответа сервера - оставьте 3000)

Сообщать о недоступности - Да/Нет (если Да, то в случае отсутствия ответа будет выводиться сообщение. В противном случае просто ничего не будет)

Город -  323776 (код города. Можно вводить наименование, но лучше код. Код смотрим на сайте openweathermap.org - находим город и берем его код.

Страна - tr (Код страны. Обязателен, если используется наименование города. При использовании код города, код страны не обязателен)

Язык ответа - Russian (язык, на котором будет выдаваться информация сервером openweathermap.org)

Кеширование запросов -  30 мин (промежуток, через которой модуль будет обращаться за конкретный городом повторно к серверу openweathermap.org. До его истечения, модуль будет брать значения из своего кеша)

Шкала температуры - Цельсий/Фарингейт (в какой шкале будут выдаваться температура)
 
Только текст - Да/Нет (выводит чистый текст без html тегов - используется для вывода температуры в тексте)
 
Ссылка на прогноз - Да/Нет (Формируется ссылка с формой прогноза)
 
Показывать город - Да/Нет (выводить наименования города)

Город для отображения - Анталия (какое наименование города выводить. Если пусто, то выведет, что выдаст сервер openweathermap.org, которое,  как правило, на латинице. Так же, может не оказаться нужного вам города, есть какой то рядом. Вы можете вывести погоду "рядом", а наименование задать нужное вам).

Иконка - Да/Нет (выводит графическую иконку погоды)

Дата - Да/Нет (выводи дату запроса)

Температура (сред.) - Да/Нет (выводит среднюю температуру)

Описание погоды - Да/Нет (выводит краткое описание погоды, например "Пасмурно")
 
Температура (max/min) - Да/Нет (выводит температуру в от мин до макс - диапазон)
 
Давление - Да/Нет (выводит давление)
 
Единицы давления - мм рт. ст./кПа (формат давление)
 
Ветер - Да/Нет (выводит направление и силу ветра)
 
Облачность - Да/Нет (выводит описание облачности)
 
Видимость - Да/Нет (выводит видимость в метрах)
 
Дождь - Да/Нет (выводит наличие дождя)
 
Снег - Да/Нет (выводит наличие снега)

Подключать CSS - Да/Нет (подключает CSS. С модулем поставляется описание формата используемых тегов. Вы можете в своем шаблоне описать эти теги и отключить модульное форматирование)


Как подключать на страницы?

Первый вариант (погодный информер) подключения основан на размещении экземпляра модуля в конкртеной позиции вашего шаблона. Для этого необходимо задать:

  - Выключаем показ заголовка модуля
  - Задаем необходимую позицию шаблона
  - Определяем страницы в меню, на которых экземпляр модуля будет выводиться

Второй вариант (погодный информер) - указываем в тексте контента вывод модуля. Для этого:

  - Выключаем показ заголовка модуля
  - Позицию модуля в шаблоне оставляем пустой
  - Задаем вывод модуля на всех страницах меню
  - В тексте контента (материала) задаем вызов модуля по имени или по позиции (можно через кнопку Module)

Третий вариант (в тексте) - делаем специальную настройку модуля и выводим модуль в контенте:

  - Выключаем показ заголовка модуля
  - Позицию модуля в шаблоне оставляем пустой
  - Задаем вывод модуля на всех страницах
  - На закладке "Параметры погоды" устанавливаем "Выводить текст" в "Да" и задаем только один параметр для вывода (например, среднюю температуру)
  - На закладке "Advanced" параметр "Module Style" в "None"
  - В тексте контента (материала) задаем вызов модуля по имени (можно через кнопку Module)

Где скачать модуль?

Погодный модуль можно скачать здесь или на странице загрузок http://seoprosto.net/other/download

Обновление модуля

В модуле присутствует проверка на выпуск новых версий. Как только появится новая версия, вы увидите соответствующее сообщение при работе в администраторе Joomla.
